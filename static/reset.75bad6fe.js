import{_ as I,a as M}from"./logo.bbdb2da1.js";import{E as T}from"./el-input.b010e971.js";import{E as L,a as R}from"./el-form.1983dc30.js";import{E as H}from"./el-button.99f697ac.js";import{d as $,r as h,a as F,z as A,J as P,o as K,c as N,v as i,b as s,x as _,e as r,aa as k,q as U,P as q,L as f,M as y,k as J,l as Y}from"./entry.f105df37.js";import{i as j}from"./dict.6e5b07a6.js";import{c as D}from"./passwords.81c3010f.js";import{h as Z}from"./user.e7427feb.js";import{t as v}from"./throttle.e6b946ec.js";import{C as x}from"./index.300ce7d8.js";import{_ as G}from"./plugin-vueexport-helper.c27b6911.js";import"./use-form-item.ecbcfbcd.js";import"./-initCloneObject.0972cb9e.js";import"./commonjsHelpers.042e6b4d.js";import"./-vite-browser-externalcommonjs-proxy.005f2268.js";const d=u=>(J("data-v-e8122d2c"),u=u(),Y(),u),O={class:"login-page"},Q={class:"auth-container"},W=d(()=>s("div",{class:"header-text"},[s("div",{class:"w-50 h-10 cursor-pointer mx-auto"},[s("img",{src:M,alt:"",class:"w-full h-full object-contain"})]),s("p",{id:"sub-title",class:"text-[18px] mt-1",style:{"letter-spacing":"4px"}}," Reset your password ")],-1)),X={class:"input-wrapper"},ee={class:"field-group"},te=d(()=>s("label",{id:"label-email"},"Password",-1)),se={class:"input-box"},oe=d(()=>s("svg",{class:"input-icon",viewBox:"0 0 24 24"},[s("path",{d:"M18 8h-1V6c0-2.76-2.24-5-5-5S7 3.24 7 6v2H6c-1.1 0-2 .9-2 2v10c0 1.1.9 2 2 2h12c1.1 0 2-.9 2-2V10c0-1.1-.9-2-2-2zm-6 9c-1.1 0-2-.9-2-2s.9-2 2-2 2 .9 2 2-.9 2-2 2zm3.1-9H8.9V6c0-1.71 1.39-3.1 3.1-3.1 1.71 0 3.1 1.39 3.1 3.1v2z"})],-1)),re={class:"field-group",id:"field-name"},ae=d(()=>s("label",null," Confirm Password",-1)),ne={class:"input-box"},ie=d(()=>s("svg",{class:"input-icon",viewBox:"0 0 24 24"},[s("path",{d:"M18 8h-1V6c0-2.76-2.24-5-5-5S7 3.24 7 6v2H6c-1.1 0-2 .9-2 2v10c0 1.1.9 2 2 2h12c1.1 0 2-.9 2-2V10c0-1.1-.9-2-2-2zm-6 9c-1.1 0-2-.9-2-2s.9-2 2-2 2 .9 2 2-.9 2-2 2zm3.1-9H8.9V6c0-1.71 1.39-3.1 3.1-3.1 1.71 0 3.1 1.39 3.1 3.1v2z"})],-1)),le={class:"toggle-mode"},de=d(()=>s("span",{id:"toggle-text"},"Already have an account?",-1)),ce=$({__name:"reset",emits:["update:closeDialog"],setup(u,{emit:pe}){const c=h(),p=h(!1),l=h(j());F();const g=A(),a=P({password_new:"",confirm_Password:"",checkList:[]}),E=P({password_new:[{validator:(t,e,o)=>{e===""?o(new Error("Please enter a valide password")):(a.checkList.length!==2&&o(new Error("Your password does not match")),o())},trigger:"blur"},{min:8,max:20,message:"Password length must be between 8 and 20 characters",trigger:"blur"}],confirm_Password:[{validator:(t,e,o)=>{e===""?o(new Error("Please input the password again")):e!==a.password_new?o(new Error("Your password does not match")):o()},trigger:"blur"}]}),V=()=>{const{password_new:t}=a,e=D(t);a.checkList=[],e.criteriaMet&&a.checkList.push(l==null?void 0:l.value[0]),e.lengthMet&&a.checkList.push(l==null?void 0:l.value[1])},C=t=>/^[A-Za-z0-9_-]+$/.test(t),S=t=>{const e=t.split(".");if(e.length!==3)return!1;for(const o of e)if(!C(o))return!1;return!0},m=async t=>{t&&await t.validate(async e=>{if(e){if(p.value)return;try{if(!g.getToken)return f.warning("Invalid link");if(!S(g.getToken))return f.warning("Parameter error");p.value=!0;const o=await Z({token:g.getToken||"",password_new:x.SHA256(a.password_new).toString(x.enc.Hex)});p.value=!1,o&&o.code===200?(f.success(o.msg),y("/login")):f.error(o.msg)}catch{p.value=!1}}})};return(t,e)=>{const o=I,w=T,b=L,z=H,B=R;return K(),N("div",O,[i(o),s("div",Q,[W,i(B,{model:r(a),class:"",ref_key:"ruleFormRef",ref:c,rules:r(E),"label-position":"top","hide-required-asterisk":"",onSubmit:e[5]||(e[5]=q(n=>("throttle"in t?t.throttle:r(v))(()=>{m(r(c))}),["prevent"]))},{default:_(()=>[s("div",X,[s("div",ee,[te,s("div",se,[oe,i(b,{label:"",prop:"password_new",onInput:V},{default:_(()=>[i(w,{modelValue:r(a).password_new,"onUpdate:modelValue":e[0]||(e[0]=n=>r(a).password_new=n),type:"text",onKeyup:e[1]||(e[1]=k(n=>("throttle"in t?t.throttle:r(v))(()=>{m(r(c))}),["enter","native"])),placeholder:"Enter your password",id:"input-email"},null,8,["modelValue"])]),_:1})])]),s("div",re,[ae,s("div",ne,[ie,i(b,{label:"",prop:"confirm_Password"},{default:_(()=>[i(w,{modelValue:r(a).confirm_Password,"onUpdate:modelValue":e[2]||(e[2]=n=>r(a).confirm_Password=n),type:"text",onKeyup:e[3]||(e[3]=k(n=>("throttle"in t?t.throttle:r(v))(()=>{m(r(c))}),["enter","native"])),placeholder:"Enter your password"},null,8,["modelValue"])]),_:1})])])]),i(z,{class:"btn-submit",id:"btn-submit",onClick:e[4]||(e[4]=n=>("throttle"in t?t.throttle:r(v))(()=>{m(r(c))})),loading:r(p)},{default:_(()=>[U(" reset ")]),_:1},8,["loading"])]),_:1},8,["model","rules"]),s("div",le,[de,s("a",{id:"toggle-link",onClick:e[6]||(e[6]=n=>("navigateTo"in t?t.navigateTo:r(y))("/login"))},"Log in")])])])}}});const ze=G(ce,[["__scopeId","data-v-e8122d2c"]]);export{ze as default};
